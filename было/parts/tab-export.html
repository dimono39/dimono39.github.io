<h2>üíæ –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤</h2>

<div class="export-buttons" style="margin-bottom: 30px;">
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
        <button class="btn btn-success" onclick="exportModule.exportToExcel()">
            üìä Excel –æ—Ç—á–µ—Ç
        </button>
        <button class="btn btn-print" onclick="exportModule.exportToPDF()">
            üìÑ PDF –æ—Ç—á–µ—Ç
        </button>
        <button class="btn" onclick="exportModule.exportHTML()">
            üåê HTML –æ—Ç—á–µ—Ç
        </button>
        <button class="btn" onclick="exportModule.exportToCSV()">
            üìã CSV –¥–∞–Ω–Ω—ã–µ
        </button>
        <button class="btn" onclick="exportModule.exportJSON()">
            üíæ JSON (—Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è)
        </button>
        <button class="btn" onclick="exportModule.exportForEJournal()">
            üìí –î–ª—è —ç–ª.–¥–Ω–µ–≤–Ω–∏–∫–∞
        </button>
        <button class="btn" onclick="exportModule.printFullReport()">
            üñ®Ô∏è –ü–µ—á–∞—Ç—å –Ω–∞ –ê4
        </button>
        <button class="btn" onclick="exportModule.printOptimizedReport()">
            üìÑ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—á–∞—Ç—å
        </button>
    </div>
</div>

<div class="chart-container">
    <h3>üìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–∞</h3>
    <div id="reportPreview">
        <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–∞ -->
    </div>
</div>

<div class="chart-container" style="margin-top: 20px;">
    <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
        <div>
            <h4>–§–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞</h4>
            <div class="form-group">
                <label>–¢–∏–ø —Ñ–∞–π–ª–∞:</label>
                <select id="exportFormat">
                    <option value="excel">Excel (.xlsx)</option>
                    <option value="pdf">PDF (.pdf)</option>
                    <option value="html">HTML (.html)</option>
                    <option value="csv">CSV (.csv)</option>
                    <option value="json">JSON (.json)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>–ö–æ–¥–∏—Ä–æ–≤–∫–∞:</label>
                <select id="exportEncoding">
                    <option value="utf-8">UTF-8</option>
                    <option value="windows-1251">Windows-1251</option>
                </select>
            </div>
        </div>
        
        <div>
            <h4>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ</h4>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="includeResults" checked> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—á–∞—â–∏—Ö—Å—è
                </label>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="includeAnalytics" checked> –ê–Ω–∞–ª–∏—Ç–∏–∫—É
                </label>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="includeErrors" checked> –û—à–∏–±–∫–∏
                </label>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="includeCharts"> –ì—Ä–∞—Ñ–∏–∫–∏
                </label>
            </div>
        </div>
        
        <div>
            <h4>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h4>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="includeMetadata" checked> –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
                </label>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="includeComments"> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                </label>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="protectFile"> –ó–∞—â–∏—Ç–∞ —Ñ–∞–π–ª–∞
                </label>
            </div>
        </div>
    </div>
    
    <button class="btn btn-success" onclick="exportWithSettings()" style="margin-top: 20px;">
        üöÄ –≠–∫—Å–ø–æ—Ä—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
    </button>
</div>

<div class="chart-container" style="margin-top: 20px;">
    <h3>üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏</h3>
    
    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
        <button class="btn" onclick="createBackupManually()">
            üíæ –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
        </button>
        <button class="btn" onclick="showBackupRestoreDialog()">
            üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –∫–æ–ø–∏–∏
        </button>
        <button class="btn" onclick="showBackupManagement()">
            üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ø–∏—è–º–∏
        </button>
    </div>
    
    <div id="backupInfo" style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
        <p><strong>–ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è:</strong> <span id="lastBackupTime">–ù–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å</span></p>
        <p><strong>–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:</strong> <span id="dataSize">0 KB</span></p>
        <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ø–∏–π:</strong> <span id="backupCount">0</span></p>
    </div>
</div>

<div class="chart-container" style="margin-top: 20px;">
    <h3>üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–∞–º–∏</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <button class="btn" onclick="exportToMES()">
            üè´ –ú–≠–® (–ú–æ—Å–∫–æ–≤—Å–∫–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —à–∫–æ–ª–∞)
        </button>
        <button class="btn" onclick="exportToDnevnikRu()">
            üìí –î–Ω–µ–≤–Ω–∏–∫.—Ä—É
        </button>
        <button class="btn" onclick="exportToElJur()">
            ‚öñÔ∏è –≠–ª–ñ—É—Ä
        </button>
        <button class="btn" onclick="exportToGoogleClassroom()">
            üéì Google Classroom
        </button>
    </div>
    
    <div style="margin-top: 20px; padding: 15px; background: #e8f4fc; border-radius: 8px;">
        <h4>üìã –§–æ—Ä–º–∞—Ç—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</h4>
        <ul style="margin: 10px 0 0 20px;">
            <li><strong>CSV</strong> - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º</li>
            <li><strong>JSON</strong> - –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ API</li>
            <li><strong>Excel</strong> - –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –≤ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã</li>
            <li><strong>XML</strong> - –¥–ª—è —Å–∏—Å—Ç–µ–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö —ç—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç</li>
        </ul>
    </div>
</div>

<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–∫–ª–∞–¥–∫–∏
document.addEventListener('DOMContentLoaded', function() {
    updateReportPreview();
    updateBackupInfo();
});

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —ç—Ç–æ–π –≤–∫–ª–∞–¥–∫–∏
function updateBackupInfo() {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏—è—Ö
    const backups = Object.keys(localStorage)
        .filter(key => key.startsWith('backup_'))
        .sort()
        .reverse();
    
    document.getElementById('backupCount').textContent = backups.length;
    
    if (backups.length > 0) {
        try {
            const lastBackupKey = backups[0];
            const lastBackup = JSON.parse(localStorage.getItem(lastBackupKey));
            document.getElementById('lastBackupTime').textContent = lastBackup.timestamp || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        } catch (error) {
            document.getElementById('lastBackupTime').textContent = '–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è';
        }
    }
    
    // –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
    const dataSize = JSON.stringify(localStorage).length;
    document.getElementById('dataSize').textContent = formatFileSize(dataSize);
}

function formatFileSize(bytes) {
    if (bytes < 1024) return bytes + ' B';
    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(2) + ' KB';
    return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
}

function createBackupManually() {
    if (app.saveData()) {
        app.createBackup();
        updateBackupInfo();
        showNotification('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞ –≤—Ä—É—á–Ω—É—é', 'success');
    }
}

function showBackupRestoreDialog() {
    const backups = Object.keys(localStorage)
        .filter(key => key.startsWith('backup_'))
        .map(key => {
            try {
                const data = JSON.parse(localStorage.getItem(key));
                return {
                    key: key,
                    timestamp: data.timestamp || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    subject: data.data?.test?.subject || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
                    className: data.data?.test?.class || '–ë–µ–∑ –∫–ª–∞—Å—Å–∞'
                };
            } catch (error) {
                return null;
            }
        })
        .filter(b => b !== null)
        .sort((a, b) => b.key.localeCompare(a.key));
    
    if (backups.length === 0) {
        showNotification('–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã', 'warning');
        return;
    }
    
    let html = '<h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:</h3>';
    html += '<div style="max-height: 300px; overflow-y: auto; margin: 15px 0;">';
    
    backups.forEach(backup => {
        html += `
            <div class="backup-item" onclick="selectBackup('${backup.key}')">
                <strong>${backup.timestamp}</strong><br>
                <small>${backup.subject} - ${backup.className}</small>
            </div>
        `;
    });
    
    html += '</div>';
    html += `
        <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
            <button class="btn" onclick="hideModal()">–û—Ç–º–µ–Ω–∞</button>
            <button class="btn btn-success" id="restoreBackupBtn" disabled onclick="restoreSelectedBackup()">
                üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
            </button>
        </div>
    `;
    
    showModal('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏', html);
    
    window.selectedBackupKey = null;
}

function selectBackup(key) {
    window.selectedBackupKey = key;
    document.getElementById('restoreBackupBtn').disabled = false;
    
    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    document.querySelectorAll('.backup-item').forEach(item => {
        item.style.background = '';
    });
    
    event.target.closest('.backup-item').style.background = '#e8f4fc';
}

function restoreSelectedBackup() {
    if (!window.selectedBackupKey) return;
    
    if (confirm('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —ç—Ç—É —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é? –¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
        try {
            const backup = JSON.parse(localStorage.getItem(window.selectedBackupKey));
            if (backup && backup.data) {
                app.data = backup.data;
                app.saveData();
                app.renderAll();
                hideModal();
                showNotification('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞', 'success');
            }
        } catch (error) {
            showNotification('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: ' + error.message, 'error');
        }
    }
}

function showBackupManagement() {
    const backups = Object.keys(localStorage)
        .filter(key => key.startsWith('backup_'))
        .map(key => {
            try {
                const data = JSON.parse(localStorage.getItem(key));
                const size = JSON.stringify(data).length;
                return {
                    key: key,
                    timestamp: data.timestamp || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    subject: data.data?.test?.subject || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
                    className: data.data?.test?.class || '–ë–µ–∑ –∫–ª–∞—Å—Å–∞',
                    size: size
                };
            } catch (error) {
                return null;
            }
        })
        .filter(b => b !== null)
        .sort((a, b) => b.key.localeCompare(a.key));
    
    let html = '<h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏</h3>';
    
    if (backups.length === 0) {
        html += '<p>–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
    } else {
        html += `
            <p>–í—Å–µ–≥–æ –∫–æ–ø–∏–π: ${backups.length}</p>
            <div style="max-height: 400px; overflow-y: auto; margin: 15px 0;">
                <table style="width: 100%; font-size: 12px;">
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            <th>–î–∞–Ω–Ω—ã–µ</th>
                            <th>–†–∞–∑–º–µ—Ä</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
        `;
        
        backups.forEach(backup => {
            html += `
                <tr>
                    <td>${backup.timestamp}</td>
                    <td>${backup.subject} - ${backup.className}</td>
                    <td>${formatFileSize(backup.size)}</td>
                    <td>
                        <button class="btn btn-sm" onclick="restoreBackup('${backup.key}')" title="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å">
                            üîÑ
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteBackup('${backup.key}')" title="–£–¥–∞–ª–∏—Ç—å">
                            üóëÔ∏è
                        </button>
                        <button class="btn btn-sm" onclick="exportBackup('${backup.key}')" title="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å">
                            üì•
                        </button>
                    </td>
                </tr>
            `;
        });
        
        html += `
                    </tbody>
                </table>
            </div>
            
            <div style="margin-top: 20px;">
                <button class="btn btn-danger" onclick="deleteAllBackups()">
                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–ø–∏–∏
                </button>
                <button class="btn" onclick="exportAllBackups()" style="margin-left: 10px;">
                    üì• –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ
                </button>
            </div>
        `;
    }
    
    html += `
        <div style="margin-top: 20px;">
            <button class="btn" onclick="hideModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    `;
    
    showModal('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏', html);
}

function deleteBackup(key) {
    if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é?')) {
        localStorage.removeItem(key);
        showBackupManagement();
        updateBackupInfo();
        showNotification('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —É–¥–∞–ª–µ–Ω–∞', 'success');
    }
}

function deleteAllBackups() {
    const backups = Object.keys(localStorage).filter(key => key.startsWith('backup_'));
    
    if (backups.length === 0) {
        showNotification('–ù–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è', 'info');
        return;
    }
    
    if (confirm(`–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏? (${backups.length} —à—Ç—É–∫)`)) {
        backups.forEach(key => localStorage.removeItem(key));
        hideModal();
        updateBackupInfo();
        showNotification(`–£–¥–∞–ª–µ–Ω–æ ${backups.length} —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π`, 'success');
    }
}

function exportBackup(key) {
    try {
        const backup = localStorage.getItem(key);
        const data = JSON.parse(backup);
        const jsonStr = JSON.stringify(data, null, 2);
        const filename = `—Ä–µ–∑–µ—Ä–≤–Ω–∞—è_–∫–æ–ø–∏—è_${key.replace('backup_', '')}.json`;
        
        utils.downloadFile(jsonStr, filename, 'application/json');
        showNotification('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞', 'success');
    } catch (error) {
        showNotification('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ' + error.message, 'error');
    }
}

function exportAllBackups() {
    const backups = {};
    
    Object.keys(localStorage)
        .filter(key => key.startsWith('backup_'))
        .forEach(key => {
            try {
                backups[key] = JSON.parse(localStorage.getItem(key));
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∫–æ–ø–∏–∏', key, error);
            }
        });
    
    const jsonStr = JSON.stringify(backups, null, 2);
    const filename = `–≤—Å–µ_—Ä–µ–∑–µ—Ä–≤–Ω—ã–µ_–∫–æ–ø–∏–∏_${new Date().toISOString().slice(0, 10)}.json`;
    
    utils.downloadFile(jsonStr, filename, 'application/json');
    showNotification(`–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${Object.keys(backups).length} —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π`, 'success');
}

function exportWithSettings() {
    const format = document.getElementById('exportFormat').value;
    const includeResults = document.getElementById('includeResults').checked;
    const includeAnalytics = document.getElementById('includeAnalytics').checked;
    const includeErrors = document.getElementById('includeErrors').checked;
    const includeCharts = document.getElementById('includeCharts').checked;
    const includeMetadata = document.getElementById('includeMetadata').checked;
    const includeComments = document.getElementById('includeComments').checked;
    
    // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å —É—á–µ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫
    // –í —É–ø—Ä–æ—â–µ–Ω–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –ø—Ä–æ—Å—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º
    
    switch(format) {
        case 'excel':
            exportModule.exportToExcel();
            break;
        case 'pdf':
            exportModule.exportToPDF();
            break;
        case 'html':
            exportModule.exportHTML();
            break;
        case 'csv':
            exportModule.exportToCSV();
            break;
        case 'json':
            exportModule.exportJSON();
            break;
    }
    
    showNotification(`–≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ ${format} –∑–∞–ø—É—â–µ–Ω`, 'info');
}

// –§—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–∑–∞–≥–ª—É—à–∫–∏)
function exportToMES() {
    showNotification('–≠–∫—Å–ø–æ—Ä—Ç –≤ –ú–≠–® (—Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)', 'info');
}

function exportToDnevnikRu() {
    showNotification('–≠–∫—Å–ø–æ—Ä—Ç –≤ –î–Ω–µ–≤–Ω–∏–∫.—Ä—É (—Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)', 'info');
}

function exportToElJur() {
    showNotification('–≠–∫—Å–ø–æ—Ä—Ç –≤ –≠–ª–ñ—É—Ä (—Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)', 'info');
}

function exportToGoogleClassroom() {
    showNotification('–≠–∫—Å–ø–æ—Ä—Ç –≤ Google Classroom (—Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)', 'info');
}
</script>