<h2>üí° –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>

<div class="print-only">
    <div class="header" style="padding: 15px; margin-bottom: 20px;">
        <h2 style="font-size: 1.5em; margin: 0;">–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç –ø–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ</h2>
        <p style="margin: 5px 0;">
            <strong id="printSubjectClass"></strong> | 
            <span id="printTheme"></span> | 
            <span id="printDate"></span>
        </p>
    </div>
</div>

<h3 class="section-title">üìä –û–±—â–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã</h3>
<div id="workAnalysis" class="recommendation-card">
    <!-- –û–±—â–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã -->
</div>

<h3 class="section-title">üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h3>
<div id="keyConclusions">
    <!-- –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã -->
</div>

<h3 class="section-title">üîß –ü–ª–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</h3>
<div id="correctionPlan">
    <!-- –ü–ª–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π -->
</div>

<h3 class="section-title">üöÄ –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏</h3>
<div id="nextSteps">
    <!-- –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏ -->
</div>

<h3 class="section-title">üë• –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
<div id="individualRecommendations">
    <!-- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
</div>

<h3 class="section-title">üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π</h3>
<div id="parentRecommendations" class="recommendation-card">
    <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π -->
</div>

<div class="print-controls no-print" style="margin-top: 30px;">
    <h4>üñ®Ô∏è –ü–µ—á–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</h4>
    <p>–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –æ—Ç—á–µ—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –¥–ª—è:</p>
    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
        <button class="btn btn-print" onclick="printRecommendationsForTeacher()">
            üë©‚Äçüè´ –î–ª—è —É—á–∏—Ç–µ–ª—è
        </button>
        <button class="btn btn-print" onclick="printRecommendationsForParents()">
            üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –î–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π
        </button>
        <button class="btn btn-print" onclick="printRecommendationsForAdmin()">
            üè´ –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏
        </button>
        <button class="btn" onclick="exportRecommendationsToWord()">
            üìù –í Word
        </button>
    </div>
</div>

<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–∫–ª–∞–¥–∫–∏
document.addEventListener('DOMContentLoaded', function() {
    updateRecommendations();
});

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —ç—Ç–æ–π –≤–∫–ª–∞–¥–∫–∏
function updateRecommendations() {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏
    document.getElementById('printSubjectClass').textContent = 
        `${app.data.test.subject || ''}, ${app.data.test.class || ''}`;
    document.getElementById('printTheme').textContent = app.data.test.theme || '';
    document.getElementById('printDate').textContent = 
        new Date(app.data.test.testDate).toLocaleDateString('ru-RU') || '';
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    generateWorkAnalysis();
    generateKeyConclusions();
    generateCorrectionPlan();
    generateNextSteps();
    generateIndividualRecommendations();
    generateParentRecommendations();
}

function generateWorkAnalysis() {
    const container = document.getElementById('workAnalysis');
    if (!container) return;
    
    const totalStudents = app.data.students.length;
    const avgScore = exportModule.calculateAverageScore();
    const successRate = exportModule.calculateSuccessRate();
    const qualityRate = exportModule.calculateQualityRate();
    
    let analysis = `<p><strong>–û–±—â–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:</strong></p>`;
    analysis += `<p>–†–∞–±–æ—Ç—É –≤—ã–ø–æ–ª–Ω—è–ª–∏ <strong>${totalStudents}</strong> —É—á–∞—â–∏—Ö—Å—è. `;
    analysis += `–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª —Å–æ—Å—Ç–∞–≤–∏–ª <strong>${avgScore.toFixed(2)}</strong>. `;
    analysis += `–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å - <strong>${successRate.toFixed(1)}%</strong>, `;
    analysis += `–∫–∞—á–µ—Å—Ç–≤–æ –∑–Ω–∞–Ω–∏–π - <strong>${qualityRate.toFixed(1)}%</strong>.</p>`;
    
    // –ê–Ω–∞–ª–∏–∑ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
    if (app.data.tasks.length > 0) {
        const easyTasks = app.data.tasks.filter(t => t.level <= 2).length;
        const hardTasks = app.data.tasks.filter(t => t.level >= 3).length;
        analysis += `<p>–†–∞–±–æ—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç <strong>${easyTasks}</strong> –∑–∞–¥–∞–Ω–∏–π –±–∞–∑–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏ `;
        analysis += `<strong>${hardTasks}</strong> –∑–∞–¥–∞–Ω–∏–π –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.</p>`;
    }
    
    container.innerHTML = analysis;
}

function generateKeyConclusions() {
    const container = document.getElementById('keyConclusions');
    if (!container) return;
    
    const successRate = exportModule.calculateSuccessRate();
    const qualityRate = exportModule.calculateQualityRate();
    
    let conclusions = '';
    
    if (successRate >= 80) {
        conclusions = `
            <div class="recommendation-card recommendation-info">
                <h4>‚úÖ –í—ã—Å–æ–∫–∞—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å</h4>
                <p>–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —É—á–∞—â–∏—Ö—Å—è —É—Å–ø–µ—à–Ω–æ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å —Ä–∞–±–æ—Ç–æ–π. –ú–∞—Ç–µ—Ä–∏–∞–ª —É—Å–≤–æ–µ–Ω –≤ –ø–æ–ª–Ω–æ–º –æ–±—ä–µ–º–µ.</p>
            </div>
        `;
    } else if (successRate >= 60) {
        conclusions = `
            <div class="recommendation-card recommendation-warning">
                <h4>‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å</h4>
                <p>–ï—Å—Ç—å —É—á–∞—â–∏–µ—Å—è, –∏—Å–ø—ã—Ç—ã–≤–∞—é—â–∏–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏. –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –ø—Ä–æ–±–ª–µ–º–Ω—ã–º–∏ —Ç–µ–º–∞–º–∏.</p>
            </div>
        `;
    } else {
        conclusions = `
            <div class="recommendation-card recommendation-critical">
                <h4>‚ùå –ù–∏–∑–∫–∞—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å</h4>
                <p>–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å —É—á–∞—â–∏—Ö—Å—è –Ω–µ —É—Å–≤–æ–∏–ª–∞ –º–∞—Ç–µ—Ä–∏–∞–ª. –ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞.</p>
            </div>
        `;
    }
    
    if (qualityRate >= 40) {
        conclusions += `
            <div class="recommendation-card recommendation-info">
                <h4>‚≠ê –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∑–Ω–∞–Ω–∏–π</h4>
                <p>–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—â–∏—Ö—Å—è –ø–æ–∫–∞–∑–∞–ª–æ –≤—ã—Å–æ–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.</p>
            </div>
        `;
    }
    
    container.innerHTML = conclusions;
}

function generateCorrectionPlan() {
    const container = document.getElementById('correctionPlan');
    if (!container) return;
    
    const plan = `
        <div class="recommendation-card">
            <h4>üìÖ –ë–ª–∏–∂–∞–π—à–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)</h4>
            <ol>
                <li>–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –Ω–∞ –±–ª–∏–∂–∞–π—à–µ–º —É—Ä–æ–∫–µ</li>
                <li>–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –¥–ª—è –æ—Ç—Å—Ç–∞—é—â–∏—Ö —É—á–∞—â–∏—Ö—Å—è</li>
                <li>–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ –ø—Ä–æ–±–ª–µ–º–Ω—ã–º —Ç–µ–º–∞–º</li>
                <li>–ü—Ä–æ–∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª–µ–π –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Ä–∞–±–æ—Ç—ã</li>
            </ol>
        </div>
        
        <div class="recommendation-card">
            <h4>üéØ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (–º–µ—Å—è—Ü)</h4>
            <ol>
                <li>–í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–µ–º—ã –≤ –ø–ª–∞–Ω –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</li>
                <li>–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π</li>
                <li>–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —á–µ—Ä–µ–∑ 3-4 –Ω–µ–¥–µ–ª–∏</li>
                <li>–°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—á—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</li>
            </ol>
        </div>
    `;
    
    container.innerHTML = plan;
}

function generateNextSteps() {
    const container = document.getElementById('nextSteps');
    if (!container) return;
    
    const steps = `
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-value">üìù</div>
                <div class="kpi-label">–†–∞–±–æ—Ç–∞ –Ω–∞–¥ –æ—à–∏–±–∫–∞–º–∏</div>
                <small>–ù–∞ –±–ª–∏–∂–∞–π—à–µ–º —É—Ä–æ–∫–µ</small>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">üë•</div>
                <div class="kpi-label">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</div>
                <small>–í —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏</small>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">üìÖ</div>
                <div class="kpi-label">–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å</div>
                <small>–ß–µ—Ä–µ–∑ 3-4 –Ω–µ–¥–µ–ª–∏</small>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">üìä</div>
                <div class="kpi-label">–ê–Ω–∞–ª–∏–∑ –¥–∏–Ω–∞–º–∏–∫–∏</div>
                <small>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏</small>
            </div>
        </div>
    `;
    
    container.innerHTML = steps;
}

function generateIndividualRecommendations() {
    const container = document.getElementById('individualRecommendations');
    if (!container) return;
    
    // –ù–∞—Ö–æ–¥–∏–º —É—á–∞—â–∏—Ö—Å—è —Å –Ω–∏–∑–∫–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
    const lowPerformingStudents = [];
    const highPerformingStudents = [];
    
    app.data.students.forEach((student, index) => {
        const scores = app.data.results[index] || [];
        const total = scores.reduce((sum, score) => sum + (score || 0), 0);
        const grade = app.calculateGrade(total);
        
        if (grade <= 2) {
            lowPerformingStudents.push({ student, index, grade, total });
        } else if (grade >= 4) {
            highPerformingStudents.push({ student, index, grade, total });
        }
    });
    
    let recommendations = '';
    
    if (lowPerformingStudents.length > 0) {
        recommendations += `
            <div class="recommendation-card recommendation-critical">
                <h4>üë• –£—á–∞—â–∏–µ—Å—è, —Ç—Ä–µ–±—É—é—â–∏–µ –æ—Å–æ–±–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è</h4>
                <ul>
                    ${lowPerformingStudents.map(s => 
                        `<li><strong>${s.student}</strong> - –æ—Ü–µ–Ω–∫–∞ ${s.grade}, ${s.total} –±–∞–ª–ª–æ–≤</li>`
                    ).join('')}
                </ul>
                <p><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong> –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è, —Ä–∞–±–æ—Ç–∞ —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏.</p>
            </div>
        `;
    }
    
    if (highPerformingStudents.length > 0) {
        recommendations += `
            <div class="recommendation-card recommendation-info">
                <h4>‚≠ê –£—á–∞—â–∏–µ—Å—è —Å –≤—ã—Å–æ–∫–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏</h4>
                <ul>
                    ${highPerformingStudents.slice(0, 5).map(s => 
                        `<li><strong>${s.student}</strong> - –æ—Ü–µ–Ω–∫–∞ ${s.grade}, ${s.total} –±–∞–ª–ª–æ–≤</li>`
                    ).join('')}
                </ul>
                <p><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong> –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, —É—á–∞—Å—Ç–∏–µ –≤ –æ–ª–∏–º–ø–∏–∞–¥–∞—Ö.</p>
            </div>
        `;
    }
    
    container.innerHTML = recommendations || '<p>–í—Å–µ —É—á–∞—â–∏–µ—Å—è –ø–æ–∫–∞–∑–∞–ª–∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.</p>';
}

function generateParentRecommendations() {
    const container = document.getElementById('parentRecommendations');
    if (!container) return;
    
    const recommendations = `
        <h4>üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π</h4>
        <p><strong>–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong></p>
        <ul>
            <li>–û–±—Å—É–¥–∏—Ç–µ —Å —Ä–µ–±–µ–Ω–∫–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã</li>
            <li>–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏</li>
            <li>–ü–æ–º–æ–≥–∏—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ç–µ–º</li>
            <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π</li>
        </ul>
        
        <p><strong>–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —à–∞–≥–∏:</strong></p>
        <ol>
            <li>–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞–±–æ—Ç—É –≤–º–µ—Å—Ç–µ —Å —Ä–µ–±–µ–Ω–∫–æ–º</li>
            <li>–í—ã—è–≤–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–æ–∫</li>
            <li>–°–æ—Å—Ç–∞–≤—å—Ç–µ –ø–ª–∞–Ω —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–µ–ª–æ–≤</li>
            <li>–†–µ–≥—É–ª—è—Ä–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å</li>
        </ol>
        
        <p style="margin-top: 15px; font-size: 12px; color: #666;">
            <em>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–æ—Å—è—Ç –æ–±—â–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —É—á–∏—Ç–µ–ª—é.</em>
        </p>
    `;
    
    container.innerHTML = recommendations;
}

// –§—É–Ω–∫—Ü–∏–∏ –ø–µ—á–∞—Ç–∏
function printRecommendationsForTeacher() {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    const activeTab = localStorage.getItem('activeTab');
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –±–ª–æ–∫–∏
    document.querySelectorAll('.tab-content').forEach(tab => {
        if (tab.id === 'recommendations') {
            tab.classList.add('active');
        } else {
            tab.classList.add('no-print');
        }
    });
    
    // –°–∫—Ä—ã–≤–∞–µ–º –Ω–µ–Ω—É–∂–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
    document.querySelectorAll('.no-print, .print-controls').forEach(el => {
        el.style.display = 'none';
    });
    
    // –ü–µ—á–∞—Ç—å
    window.print();
    
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    setTimeout(() => {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active', 'no-print');
        });
        
        document.querySelectorAll('.no-print, .print-controls').forEach(el => {
            el.style.display = '';
        });
        
        if (activeTab) {
            const tabButton = document.querySelector(`.tab-btn[onclick*="${activeTab}"]`);
            if (tabButton) {
                tabButton.click();
            }
        }
    }, 500);
}

function exportRecommendationsToWord() {
    // –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ Word
    const content = generateWordContent();
    const blob = new Blob([content], { type: 'application/msword' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏_${app.data.test.subject || ''}_${new Date().toISOString().slice(0, 10)}.doc`;
    a.click();
    URL.revokeObjectURL(url);
}

function generateWordContent() {
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è Word
    return `
        <html>
        <head>
            <meta charset="UTF-8">
            <title>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ä–∞–±–æ—Ç—ã</title>
            <style>
                body { font-family: Arial, sans-serif; margin: 2cm; }
                h1, h2, h3 { color: #2c3e50; }
                .section { margin-bottom: 20px; }
                ul, ol { margin-left: 20px; }
            </style>
        </head>
        <body>
            <h1>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã</h1>
            <p>–ü—Ä–µ–¥–º–µ—Ç: ${app.data.test.subject || ''}</p>
            <p>–ö–ª–∞—Å—Å: ${app.data.test.class || ''}</p>
            <p>–¢–µ–º–∞: ${app.data.test.theme || ''}</p>
            <p>–î–∞—Ç–∞: ${new Date(app.data.test.testDate).toLocaleDateString('ru-RU') || ''}</p>
            
            <div class="section">
                <h2>–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h2>
                ${document.getElementById('keyConclusions')?.innerHTML || ''}
            </div>
            
            <div class="section">
                <h2>–ü–ª–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</h2>
                ${document.getElementById('correctionPlan')?.innerHTML || ''}
            </div>
            
            <div class="section">
                <h2>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
                ${document.getElementById('individualRecommendations')?.innerHTML || ''}
            </div>
            
            <p style="margin-top: 50px; font-size: 11px; color: #666;">
                –û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω ${new Date().toLocaleDateString('ru-RU')}
            </p>
        </body>
        </html>
    `;
}
</script>