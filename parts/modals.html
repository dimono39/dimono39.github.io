<!-- ==================== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê –ò –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==================== -->

<!-- –û—Å–Ω–æ–≤–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div class="modal-overlay" id="modalOverlay" style="display: none;">
    <div class="modal-content" id="modalContent">
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    </div>
</div>

<!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é -->
<div class="context-menu" id="contextMenu" style="display: none;"></div>

<!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
<div id="notificationsContainer" class="notifications-container"></div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ü–µ–Ω–æ–∫ -->
<template id="bulkEditModalTemplate">
    <div class="modal-header">
        <h3>üìù –ú–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫</h3>
        <button class="modal-close" onclick="hideModal()">√ó</button>
    </div>
    
    <div class="modal-body">
        <div class="form-group">
            <label>–î–µ–π—Å—Ç–≤–∏–µ:</label>
            <select id="bulkAction" class="modal-select">
                <option value="set">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ</option>
                <option value="add">–î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–ª—ã</option>
                <option value="subtract">–í—ã—á–µ—Å—Ç—å –±–∞–ª–ª—ã</option>
                <option value="multiply">–£–º–Ω–æ–∂–∏—Ç—å –Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</option>
                <option value="round">–û–∫—Ä—É–≥–ª–∏—Ç—å –æ—Ü–µ–Ω–∫–∏</option>
                <option value="normalize">–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å (–ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –º–∞–∫—Å. –±–∞–ª–ª—É)</option>
            </select>
        </div>
        
        <div class="form-group" id="bulkValueContainer">
            <label>–ó–Ω–∞—á–µ–Ω–∏–µ:</label>
            <input type="number" id="bulkValue" class="modal-input" value="0" step="0.1">
        </div>
        
        <div class="form-group">
            <label>–î–ª—è –∑–∞–¥–∞–Ω–∏–π:</label>
            <div class="checkbox-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="selectAllTasks" checked>
                    <span>–í—Å–µ –∑–∞–¥–∞–Ω–∏—è</span>
                </label>
                <div id="tasksCheckboxes" class="scrollable-list">
                    <!-- –ó–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label>–î–ª—è —É—á–∞—â–∏—Ö—Å—è:</label>
            <div class="checkbox-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="selectAllStudents" checked>
                    <span>–í—Å–µ —É—á–∞—â–∏–µ—Å—è</span>
                </label>
                <div id="studentsCheckboxes" class="scrollable-list">
                    <!-- –£—á–∞—â–∏–µ—Å—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label>–£—Å–ª–æ–≤–∏—è:</label>
            <select id="bulkCondition" class="modal-select">
                <option value="all">–í—Å–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</option>
                <option value="less_than">–¢–æ–ª—å–∫–æ –æ—Ü–µ–Ω–∫–∏ –º–µ–Ω—å—à–µ</option>
                <option value="greater_than">–¢–æ–ª—å–∫–æ –æ—Ü–µ–Ω–∫–∏ –±–æ–ª—å—à–µ</option>
                <option value="equal">–¢–æ–ª—å–∫–æ –æ—Ü–µ–Ω–∫–∏ —Ä–∞–≤–Ω—ã–µ</option>
            </select>
            <input type="number" id="bulkConditionValue" class="modal-input" value="0" style="margin-top: 5px;">
        </div>
        
        <div class="preview-section">
            <h4>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π:</h4>
            <div id="bulkPreview" class="preview-box">
                –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä" –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
            </div>
            <button class="btn btn-sm" onclick="previewBulkEdit()">üîÑ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
        </div>
    </div>
    
    <div class="modal-footer">
        <button class="btn" onclick="hideModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-success" onclick="applyBulkEdit()">‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    </div>
</template>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∞–º–∏ -->
<template id="errorsManagementModalTemplate">
    <div class="modal-header">
        <h3>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∞–º–∏</h3>
        <button class="modal-close" onclick="hideModal()">√ó</button>
    </div>
    
    <div class="modal-body">
        <div class="management-grid">
            <div class="management-card">
                <h4>üë§ –ü–æ —É—á–∞—â–∏–º—Å—è</h4>
                <select id="studentForErrors" class="modal-select" onchange="updateStudentErrorsInfo()">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—â–µ–≥–æ—Å—è</option>
                    <!-- –£—á–∞—â–∏–µ—Å—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </select>
                <div id="studentErrorsInfo" class="info-box"></div>
                <button class="btn btn-danger" onclick="deleteAllStudentErrors(parseInt(document.getElementById('studentForErrors').value))" 
                        id="deleteStudentErrorsBtn" disabled>
                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –æ—à–∏–±–∫–∏
                </button>
            </div>
            
            <div class="management-card">
                <h4>üìä –ü–æ —Ç–∏–ø–∞–º –æ—à–∏–±–æ–∫</h4>
                <select id="errorTypeFilter" class="modal-select" onchange="updateTypeErrorsInfo()">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ—à–∏–±–∫–∏</option>
                    <!-- –¢–∏–ø—ã –æ—à–∏–±–æ–∫ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </select>
                <div id="typeErrorsInfo" class="info-box"></div>
                <button class="btn btn-danger" onclick="deleteAllErrorsByType(document.getElementById('errorTypeFilter').value)" 
                        id="deleteTypeErrorsBtn" disabled>
                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –æ—à–∏–±–∫–∏
                </button>
            </div>
        </div>
        
        <div class="stats-card">
            <h4>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫</h4>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="totalErrorsCount">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –æ—à–∏–±–æ–∫</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="studentsWithErrorsCount">0</div>
                    <div class="stat-label">–£—á–∞—â–∏—Ö—Å—è —Å –æ—à–∏–±–∫–∞–º–∏</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="tasksWithErrorsCount">0</div>
                    <div class="stat-label">–ó–∞–¥–∞–Ω–∏–π —Å –æ—à–∏–±–∫–∞–º–∏</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="mostCommonError">‚Äî</div>
                    <div class="stat-label">–°–∞–º–∞—è —á–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞</div>
                </div>
            </div>
        </div>
        
        <div class="actions-section">
            <h4>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h4>
            <div class="action-buttons">
                <button class="btn btn-warning" onclick="showBulkDeleteErrors()">
                    üóëÔ∏è –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
                </button>
                <button class="btn" onclick="exportErrorsToCSV()">
                    üì• –≠–∫—Å–ø–æ—Ä—Ç –æ—à–∏–±–æ–∫ (CSV)
                </button>
                <button class="btn btn-danger" onclick="deleteAllErrors()" style="margin-left: auto;">
                    ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –æ—à–∏–±–∫–∏
                </button>
            </div>
        </div>
    </div>
    
    <div class="modal-footer">
        <button class="btn" onclick="hideModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</template>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —É—á–∞—â–∏—Ö—Å—è -->
<template id="importStudentsModalTemplate">
    <div class="modal-header">
        <h3>üìù –ò–º–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ —É—á–∞—â–∏—Ö—Å—è</h3>
        <button class="modal-close" onclick="hideModal()">√ó</button>
    </div>
    
    <div class="modal-body">
        <div class="import-methods">
            <div class="method-tabs">
                <button class="method-tab active" onclick="showImportMethod('text')">üìã –¢–µ–∫—Å—Ç</button>
                <button class="method-tab" onclick="showImportMethod('file')">üìÅ –§–∞–π–ª</button>
                <button class="method-tab" onclick="showImportMethod('generate')">üé≤ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            
            <div id="importTextMethod" class="import-method active">
                <p>–í–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —É—á–∞—â–∏—Ö—Å—è (–∫–∞–∂–¥–æ–µ –∏–º—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏):</p>
                <textarea id="importStudentsText" class="import-textarea" rows="10" placeholder="–ò–≤–∞–Ω–æ–≤ –ê–ª–µ–∫—Å–µ–π&#10;–ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è&#10;–°–∏–¥–æ—Ä–æ–≤ –î–º–∏—Ç—Ä–∏–π"></textarea>
                <div class="import-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="importReplace" checked>
                        <span>–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="importAutoFormat">
                        <span>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–º–µ–Ω–∞</span>
                    </label>
                </div>
            </div>
            
            <div id="importFileMethod" class="import-method">
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .txt –∏–ª–∏ .csv:</p>
                <div class="file-upload">
                    <input type="file" id="importFileInput" accept=".txt,.csv,.xlsx,.xls">
                    <label for="importFileInput" class="file-upload-label">
                        üìÅ –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª
                    </label>
                    <div id="importFileName" class="file-name"></div>
                </div>
                <div class="file-preview" id="filePreview"></div>
            </div>
            
            <div id="importGenerateMethod" class="import-method">
                <p>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã—Ö —É—á–∞—â–∏—Ö—Å—è:</p>
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—â–∏—Ö—Å—è:</label>
                    <input type="number" id="generateCount" class="modal-input" min="1" max="50" value="10">
                </div>
                <div class="form-group">
                    <label>–®–∞–±–ª–æ–Ω –∏–º–µ–Ω:</label>
                    <select id="generateTemplate" class="modal-select">
                        <option value="russian">–†—É—Å—Å–∫–∏–µ –∏–º–µ–Ω–∞</option>
                        <option value="english">–ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –∏–º–µ–Ω–∞</option>
                        <option value="mixed">–°–º–µ—à–∞–Ω–Ω—ã–µ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–î–æ–±–∞–≤–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏:</label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="generateScores" checked>
                        <span>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</span>
                    </label>
                </div>
            </div>
        </div>
        
        <div class="preview-section">
            <h4>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</h4>
            <div id="importPreview" class="preview-box scrollable-list">
                <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <button class="btn btn-sm" onclick="previewImport()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
        </div>
    </div>
    
    <div class="modal-footer">
        <button class="btn" onclick="hideModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-success" onclick="processImport()">‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>
</template>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ -->
<template id="criteriaSettingsModalTemplate">
    <div class="modal-header">
        <h3>üéØ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è</h3>
        <button class="modal-close" onclick="hideModal()">√ó</button>
    </div>
    
    <div class="modal-body">
        <div class="criteria-methods">
            <div class="method-tabs">
                <button class="method-tab active" onclick="showCriteriaMethod('standard')">üìä –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ</button>
                <button class="method-tab" onclick="showCriteriaMethod('percentage')">üìà –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ</button>
                <button class="method-tab" onclick="showCriteriaMethod('custom')">‚öôÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ</button>
                <button class="method-tab" onclick="showCriteriaMethod('presets')">üöÄ –ü—Ä–µ—Å–µ—Ç—ã</button>
            </div>
            
            <div id="criteriaStandardMethod" class="criteria-method active">
                <p>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è:</p>
                <div class="criteria-grid">
                    <div class="criteria-item">
                        <label>5 (–û—Ç–ª–∏—á–Ω–æ):</label>
                        <div class="criteria-inputs">
                            <input type="number" id="stdCriteria5min" class="criteria-input" min="0" max="100">
                            <span>‚Äî</span>
                            <input type="number" id="stdCriteria5max" class="criteria-input" min="0" max="100">
                        </div>
                    </div>
                    <div class="criteria-item">
                        <label>4 (–•–æ—Ä–æ—à–æ):</label>
                        <div class="criteria-inputs">
                            <input type="number" id="stdCriteria4min" class="criteria-input" min="0" max="100">
                            <span>‚Äî</span>
                            <input type="number" id="stdCriteria4max" class="criteria-input" min="0" max="100">
                        </div>
                    </div>
                    <div class="criteria-item">
                        <label>3 (–£–¥–æ–≤–ª.):</label>
                        <div class="criteria-inputs">
                            <input type="number" id="stdCriteria3min" class="criteria-input" min="0" max="100">
                            <span>‚Äî</span>
                            <input type="number" id="stdCriteria3max" class="criteria-input" min="0" max="100">
                        </div>
                    </div>
                    <div class="criteria-item">
                        <label>2 (–ù–µ—É–¥.):</label>
                        <div class="criteria-inputs">
                            <input type="number" id="stdCriteria2min" class="criteria-input" min="0" max="100">
                            <span>‚Äî</span>
                            <input type="number" id="stdCriteria2max" class="criteria-input" min="0" max="100">
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="criteriaPercentageMethod" class="criteria-method">
                <p>–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è:</p>
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π:</label>
                    <select id="percentageLevels" class="modal-select" onchange="updatePercentageCriteria()">
                        <option value="2">2 —É—Ä–æ–≤–Ω—è</option>
                        <option value="3">3 —É—Ä–æ–≤–Ω—è</option>
                        <option value="4" selected>4 —É—Ä–æ–≤–Ω—è</option>
                        <option value="5">5 —É—Ä–æ–≤–Ω–µ–π</option>
                    </select>
                </div>
                <div id="percentageCriteriaContainer" class="criteria-grid">
                    <!-- –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <div id="criteriaCustomMethod" class="criteria-method">
                <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞:</p>
                <div class="form-group">
                    <button class="btn btn-sm" onclick="addCustomCriterion()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</button>
                </div>
                <div id="customCriteriaContainer" class="custom-criteria-list">
                    <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div id="criteriaPresetsMethod" class="criteria-method">
                <p>–ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã:</p>
                <div class="presets-grid">
                    <button class="preset-btn" onclick="applyPreset('standard_5')">
                        <div class="preset-icon">üìä</div>
                        <div class="preset-name">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è (2-5)</div>
                    </button>
                    <button class="preset-btn" onclick="applyPreset('five_point')">
                        <div class="preset-icon">1Ô∏è‚É£</div>
                        <div class="preset-name">–ü—è—Ç–∏–±–∞–ª–ª—å–Ω–∞—è (1-5)</div>
                    </button>
                    <button class="preset-btn" onclick="applyPreset('vpr_percent')">
                        <div class="preset-icon">üìù</div>
                        <div class="preset-name">–í–ü–† (–ø—Ä–æ—Ü–µ–Ω—Ç—ã)</div>
                    </button>
                    <button class="preset-btn" onclick="applyPreset('psychology_levels')">
                        <div class="preset-icon">üß†</div>
                        <div class="preset-name">–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è (—É—Ä–æ–≤–Ω–∏)</div>
                    </button>
                    <button class="preset-btn" onclick="applyPreset('ten_point')">
                        <div class="preset-icon">üîü</div>
                        <div class="preset-name">–î–µ—Å—è—Ç–∏–±–∞–ª–ª—å–Ω–∞—è</div>
                    </button>
                    <button class="preset-btn" onclick="applyPreset('ege_points')">
                        <div class="preset-icon">üéØ</div>
                        <div class="preset-name">–ï–ì–≠ (–±–∞–ª–ª—ã)</div>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="info-card">
            <h4>üí° –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
            <div id="criteriaInfo" class="info-content">
                –í—ã–±–µ—Ä–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è, –ø–æ–¥—Ö–æ–¥—è—â—É—é –¥–ª—è –≤–∞—à–µ–≥–æ —Ç–∏–ø–∞ —Ä–∞–±–æ—Ç—ã.
            </div>
        </div>
    </div>
    
    <div class="modal-footer">
        <button class="btn" onclick="hideModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-success" onclick="saveCriteriaSettings()">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏</button>
    </div>
</template>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –æ—Ç—á–µ—Ç–æ–≤ -->
<template id="exportReportsModalTemplate">
    <div class="modal-header">
        <h3>üíæ –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤</h3>
        <button class="modal-close" onclick="hideModal()">√ó</button>
    </div>
    
    <div class="modal-body">
        <div class="export-options">
            <h4>üìÑ –§–æ—Ä–º–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞:</h4>
            <div class="export-grid">
                <button class="export-option" onclick="exportToPDF()">
                    <div class="export-icon">üìÑ</div>
                    <div class="export-name">PDF –æ—Ç—á–µ—Ç</div>
                    <div class="export-desc">–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç</div>
                </button>
                <button class="export-option" onclick="exportToExcel()">
                    <div class="export-icon">üìä</div>
                    <div class="export-name">Excel —Ç–∞–±–ª–∏—Ü–∞</div>
                    <div class="export-desc">–î–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div>
                </button>
                <button class="export-option" onclick="exportHTML()">
                    <div class="export-icon">üåê</div>
                    <div class="export-name">HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞</div>
                    <div class="export-desc">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç—á–µ—Ç</div>
                </button>
                <button class="export-option" onclick="exportJSON()">
                    <div class="export-icon">üíæ</div>
                    <div class="export-name">JSON –¥–∞–Ω–Ω—ã–µ</div>
                    <div class="export-desc">–î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏</div>
                </button>
                <button class="export-option" onclick="exportForTeacher()">
                    <div class="export-icon">üë©‚Äçüè´</div>
                    <div class="export-name">–û—Ç—á–µ—Ç –¥–ª—è —É—á–∏—Ç–µ–ª—è</div>
                    <div class="export-desc">–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏</div>
                </button>
                <button class="export-option" onclick="exportForEJournal()">
                    <div class="export-icon">üìí</div>
                    <div class="export-name">–î–ª—è —ç–ª.–¥–Ω–µ–≤–Ω–∏–∫–∞</div>
                    <div class="export-desc">–§–æ—Ä–º–∞—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –°–ì–û</div>
                </button>
            </div>
        </div>
        
        <div class="export-settings">
            <h4>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞:</h4>
            <div class="settings-grid">
                <div class="form-group">
                    <label>–í–∫–ª—é—á–∏—Ç—å –≤ –æ—Ç—á–µ—Ç:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="exportSummary" checked>
                            <span>–°–≤–æ–¥–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="exportAnalytics" checked>
                            <span>–ê–Ω–∞–ª–∏—Ç–∏–∫—É</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="exportCharts" checked>
                            <span>–ì—Ä–∞—Ñ–∏–∫–∏</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="exportRecommendations" checked>
                            <span>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="exportErrors" checked>
                            <span>–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>–ò–º—è —Ñ–∞–π–ª–∞:</label>
                    <input type="text" id="exportFilename" class="modal-input" 
                           value="–û—Ç—á–µ—Ç_–ø–æ_—Ä–∞–±–æ—Ç–µ_{{–¥–∞—Ç–∞}}">
                </div>
                
                <div class="form-group">
                    <label>–ö–∞—á–µ—Å—Ç–≤–æ PDF:</label>
                    <select id="exportQuality" class="modal-select">
                        <option value="low">–ù–∏–∑–∫–æ–µ (–±—ã—Å—Ç—Ä–µ–µ)</option>
                        <option value="medium" selected>–°—Ä–µ–¥–Ω–µ–µ</option>
                        <option value="high">–í—ã—Å–æ–∫–æ–µ</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="preview-section">
            <h4>üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</h4>
            <div id="exportPreview" class="preview-box scrollable-preview">
                <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <button class="btn btn-sm" onclick="updateExportPreview()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
        </div>
    </div>
    
    <div class="modal-footer">
        <button class="btn" onclick="hideModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-success" onclick="executeExport()">üöÄ –ù–∞—á–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç</button>
    </div>
</template>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–∫–ª—é—á–µ–Ω–∏—è -->
<template id="psychologyReportModalTemplate">
    <div class="modal-header">
        <h3>üß† –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ</h3>
        <button class="modal-close" onclick="hideModal()">√ó</button>
    </div>
    
    <div class="modal-body psychology-report">
        <div class="report-header">
            <h4>–ü—Å–∏—Ö–æ–ª–æ–≥–æ-–ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ</h4>
            <div class="report-meta">
                <div class="meta-item">
                    <strong>–î–∞—Ç–∞:</strong> <span id="psychReportDate">{{–¥–∞—Ç–∞}}</span>
                </div>
                <div class="meta-item">
                    <strong>–ì—Ä—É–ø–ø–∞:</strong> <span id="psychReportGroup">{{–∫–ª–∞—Å—Å}}</span>
                </div>
                <div class="meta-item">
                    <strong>–ú–µ—Ç–æ–¥–∏–∫–∞:</strong> <span id="psychReportMethod">{{–º–µ—Ç–æ–¥–∏–∫–∞}}</span>
                </div>
            </div>
        </div>
        
        <div class="report-section">
            <h5>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</h5>
            <div id="psychResultsSummary" class="results-summary">
                <!-- –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <div class="report-section">
            <h5>üéØ –£—Ä–æ–≤–Ω–∏ —Ä–∞–∑–≤–∏—Ç–∏—è</h5>
            <div id="psychLevelsDistribution" class="levels-distribution">
                <!-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <div class="report-section">
            <h5>üë• –ì—Ä—É–ø–ø–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h5>
            <div id="psychGroupProfile" class="group-profile">
                <!-- –ì—Ä—É–ø–ø–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <div class="report-section">
            <h5>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h5>
            <div id="psychRecommendations" class="recommendations-list">
                <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <div class="report-section">
            <h5>üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h5>
            <div class="conclusion-editor">
                <textarea id="psychConclusionText" class="conclusion-textarea" rows="6" 
                          placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–∫–ª—é—á–µ–Ω–∏—è..."></textarea>
                <div class="conclusion-tools">
                    <button class="btn btn-sm" onclick="generatePsychConclusion()">
                        ü§ñ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                    </button>
                    <button class="btn btn-sm" onclick="savePsychConclusion()">
                        üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal-footer">
        <div class="footer-actions">
            <button class="btn" onclick="printPsychologyReport()">
                üñ®Ô∏è –ü–µ—á–∞—Ç—å –æ—Ç—á–µ—Ç–∞
            </button>
            <button class="btn btn-success" onclick="savePsychologyReport()">
                ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–∫–ª—é—á–µ–Ω–∏–µ
            </button>
        </div>
    </div>
</template>