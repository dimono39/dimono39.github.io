<h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∞–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</h2>

<div class="error-management-panel">
    <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∞–º–∏</h4>
    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
        <button class="btn btn-success" onclick="showErrorManagementDialog()">
            üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∞–º–∏
        </button>
        <button class="btn btn-warning" onclick="showBulkDeleteErrors()">
            üóëÔ∏è –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
        </button>
        <button class="btn" onclick="exportErrorsToCSV()">
            üì• –≠–∫—Å–ø–æ—Ä—Ç –æ—à–∏–±–æ–∫
        </button>
        <button class="btn" onclick="showQuickErrorAdd()">
            ‚ö° –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
        </button>
    </div>
    <p style="margin: 10px 0; color: #666; font-size: 13px;">
        –í—Å–µ–≥–æ –æ—à–∏–±–æ–∫: <span id="totalErrorsCount">0</span> | 
        –£—á–∞—â–∏—Ö—Å—è —Å –æ—à–∏–±–∫–∞–º–∏: <span id="studentsWithErrorsCount">0</span>
    </p>
</div>

<button class="btn btn-warning" onclick="showBulkEditDialog()" style="margin-bottom: 20px;">
    üìù –ú–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫
</button>

<div id="resultsTableContainer" class="table-container">
    <!-- –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
</div>

<div class="chart-container" style="margin-top: 30px;">
    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        <div>
            <div class="form-group">
                <label>–£—á–∞—â–∏–π—Å—è:</label>
                <select id="errorStudent">
                    <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </select>
            </div>
            <div class="form-group">
                <label>–ó–∞–¥–∞–Ω–∏–µ:</label>
                <select id="errorTask">
                    <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </select>
            </div>
        </div>
        <div>
            <div class="form-group">
                <label>–¢–∏–ø –æ—à–∏–±–∫–∏:</label>
                <select id="errorType">
                    <option value="factual">–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏</option>
                    <option value="conceptual">–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏</option>
                    <option value="application">–û—à–∏–±–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è</option>
                    <option value="calculation">–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏</option>
                    <option value="logical">–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏</option>
                    <option value="attention">–û—à–∏–±–∫–∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</option>
                    <option value="technical">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏</option>
                </select>
            </div>
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏:</label>
                <input type="text" id="errorDescription" placeholder="–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏...">
            </div>
        </div>
    </div>
    <button class="btn btn-warning" onclick="addError()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É</button>
    <button class="btn" onclick="clearErrorForm()" style="margin-left: 10px;">–û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</button>
</div>

<!-- –ë–ª–æ–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö -->
<div id="noDataWarning" style="display: none; background: #fff3cd; padding: 20px; border-radius: 8px; margin-top: 20px;">
    <h4>‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã</h4>
    <p>–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:</p>
    <ol style="margin-left: 20px;">
        <li>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–¢–∞–∫—Å–æ–Ω–æ–º–∏—è –∑–∞–¥–∞–Ω–∏–π"</li>
        <li>–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—â–∏—Ö—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–£—á–∞—â–∏–µ—Å—è"</li>
        <li>–ó–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–ª—ã –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—ã—à–µ</li>
    </ol>
    <button class="btn" onclick="showTab('tasks')">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–¥–∞–Ω–∏—è–º</button>
    <button class="btn" onclick="showTab('students')" style="margin-left: 10px;">–ü–µ—Ä–µ–π—Ç–∏ –∫ —É—á–∞—â–∏–º—Å—è</button>
</div>

<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–∫–ª–∞–¥–∫–∏
document.addEventListener('DOMContentLoaded', function() {
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–∫–∏ –≤—ã–±–æ—Ä–∞
    updateErrorFormSelects();
    updateErrorCounters();
});

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —ç—Ç–æ–π –≤–∫–ª–∞–¥–∫–∏
function updateErrorFormSelects() {
    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ —É—á–∞—â–∏—Ö—Å—è
    const studentSelect = document.getElementById('errorStudent');
    if (studentSelect) {
        studentSelect.innerHTML = app.data.students.map((student, index) => 
            `<option value="${index}">${student}</option>`
        ).join('');
    }
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π
    const taskSelect = document.getElementById('errorTask');
    if (taskSelect) {
        taskSelect.innerHTML = app.data.tasks.map((task, index) => 
            `<option value="${index}">${index + 1}. ${task.type}</option>`
        ).join('');
    }
}

function updateErrorCounters() {
    document.getElementById('totalErrorsCount').textContent = app.data.errors.length;
    const studentsWithErrors = new Set(app.data.errors.map(e => e.studentIndex)).size;
    document.getElementById('studentsWithErrorsCount').textContent = studentsWithErrors;
}

function clearErrorForm() {
    document.getElementById('errorDescription').value = '';
}

function showQuickErrorAdd() {
    // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫
    // (—Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ app.js)
    if (typeof showQuickErrorAddDialog === 'function') {
        showQuickErrorAddDialog();
    }
}
</script>